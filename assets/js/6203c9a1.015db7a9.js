"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["39551"],{52524:function(e,r,n){n.r(r),n.d(r,{default:()=>g,frontMatter:()=>c,metadata:()=>t,assets:()=>d,toc:()=>h,contentTitle:()=>u});var t=JSON.parse('{"id":"guides/avoid-blocking","title":"Avoid getting blocked","description":"How to avoid getting blocked when scraping","source":"@site/../docs/guides/avoid_blocking.mdx","sourceDirName":"guides","slug":"/guides/avoid-blocking","permalink":"/docs/next/guides/avoid-blocking","draft":false,"unlisted":false,"editUrl":"https://github.com/apify/crawlee/edit/master/website/../docs/guides/avoid_blocking.mdx","tags":[],"version":"current","lastUpdatedBy":"Martin Ad\xe1mek","lastUpdatedAt":1741018919000,"frontMatter":{"id":"avoid-blocking","title":"Avoid getting blocked","description":"How to avoid getting blocked when scraping"},"sidebar":"docs","previous":{"title":"Scaling our crawlers","permalink":"/docs/next/guides/scaling-crawlers"},"next":{"title":"JSDOMCrawler","permalink":"/docs/next/guides/jsdom-crawler-guide"}}'),i=n("85893"),a=n("50065"),o=n("58168"),s=n("97645"),l=n("96199");let c={id:"avoid-blocking",title:"Avoid getting blocked",description:"How to avoid getting blocked when scraping"},u=void 0,d={},h=[{value:"Using browser fingerprints",id:"using-browser-fingerprints",level:2},{value:"Customizing browser fingerprints",id:"customizing-browser-fingerprints",level:2},{value:"Disabling browser fingerprints",id:"disabling-browser-fingerprints",level:2},{value:"Camoufox",id:"camoufox",level:2}];function p(e){let r={a:"a",code:"code",h2:"h2",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.p,{children:["A scraper might get blocked for numerous reasons. Let's narrow it down to the two main ones. The first is a bad or blocked IP address. You can learn about this topic in the ",(0,i.jsx)(r.a,{href:"./proxy-management",children:"proxy management guide"}),". The second reason is ",(0,i.jsx)(r.a,{href:"https://pixelprivacy.com/resources/browser-fingerprinting/",target:"_blank",rel:"noopener",children:"browser fingerprints"})," (or signatures), which we will explore more in this guide. Check the ",(0,i.jsx)(r.a,{href:"https://docs.apify.com/academy/anti-scraping",target:"_blank",rel:"noopener",children:"Apify Academy anti-scraping course"})," to gain a deeper theoretical understanding of blocking and learn a few tips and tricks."]}),"\n",(0,i.jsx)(r.p,{children:"Browser fingerprint is a collection of browser attributes and significant features that can show if our browser is a bot or a real user. Moreover, most browsers have these unique features that allow the website to track the browser even within different IP addresses. This is the main reason why scrapers should change browser fingerprints while doing browser-based scraping. In return, it should significantly reduce the blocking."}),"\n",(0,i.jsx)(r.h2,{id:"using-browser-fingerprints",children:"Using browser fingerprints"}),"\n",(0,i.jsxs)(r.p,{children:["Changing browser fingerprints can be a tedious job. Luckily, Crawlee provides this feature with zero configuration necessary - the usage of fingerprints is enabled by default and available in ",(0,i.jsx)(r.code,{children:"PlaywrightCrawler"})," and ",(0,i.jsx)(r.code,{children:"PuppeteerCrawler"}),". So whenever we build a scraper that is using one of these crawlers - the fingerprints are going to be generated for the default browser and the operating system out of the box."]}),"\n",(0,i.jsx)(r.h2,{id:"customizing-browser-fingerprints",children:"Customizing browser fingerprints"}),"\n",(0,i.jsx)(r.p,{children:"In certain cases we want to narrow down the fingerprints used - e.g. specify a certain operating system, locale or browser. This is also possible with Crawlee - the crawler can have the generation algorithm customized to reflect the particular browser version and many more. Let's take a look at the examples bellow:"}),"\n",(0,i.jsxs)(o.Z,{groupId:"avoid_blocking",children:[(0,i.jsx)(s.Z,{value:"playwright",label:"PlaywrightCrawler",default:!0,children:(0,i.jsx)(l.default,{language:"js",children:"import { PlaywrightCrawler } from 'crawlee';\nimport { BrowserName, DeviceCategory, OperatingSystemsName } from '@crawlee/browser-pool';\n\nconst crawler = new PlaywrightCrawler({\n    browserPoolOptions: {\n        useFingerprints: true, // this is the default\n        fingerprintOptions: {\n            fingerprintGeneratorOptions: {\n                browsers: [\n                    {\n                        name: BrowserName.edge,\n                        minVersion: 96,\n                    },\n                ],\n                devices: [DeviceCategory.desktop],\n                operatingSystems: [OperatingSystemsName.windows],\n            },\n        },\n    },\n    // ...\n});\n"})}),(0,i.jsx)(s.Z,{value:"puppeteer",label:"PuppeteerCrawler",children:(0,i.jsx)(l.default,{language:"js",children:"import { PuppeteerCrawler } from 'crawlee';\nimport { BrowserName, DeviceCategory } from '@crawlee/browser-pool';\n\nconst crawler = new PuppeteerCrawler({\n    browserPoolOptions: {\n        useFingerprints: true, // this is the default\n        fingerprintOptions: {\n            fingerprintGeneratorOptions: {\n                browsers: [BrowserName.chrome, BrowserName.firefox],\n                devices: [DeviceCategory.mobile],\n                locales: ['en-US'],\n            },\n        },\n    },\n    // ...\n});\n"})})]}),"\n",(0,i.jsx)(r.h2,{id:"disabling-browser-fingerprints",children:"Disabling browser fingerprints"}),"\n",(0,i.jsxs)(r.p,{children:["On the contrary, sometimes we want to entirely disable the usage of browser fingerprints. This is easy to do with Crawlee too. All we have to do is set the ",(0,i.jsx)(r.code,{children:"useFingerprints"})," option of the ",(0,i.jsx)(r.code,{children:"browserPoolOptions"})," to ",(0,i.jsx)(r.code,{children:"false"}),":"]}),"\n",(0,i.jsxs)(o.Z,{groupId:"avoid_blocking",children:[(0,i.jsx)(s.Z,{value:"playwright",label:"PlaywrightCrawler",default:!0,children:(0,i.jsx)(l.default,{language:"js",children:"import { PlaywrightCrawler } from 'crawlee';\n\nconst crawler = new PlaywrightCrawler({\n    browserPoolOptions: {\n        useFingerprints: false,\n    },\n    // ...\n});\n"})}),(0,i.jsx)(s.Z,{value:"puppeteer",label:"PuppeteerCrawler",children:(0,i.jsx)(l.default,{language:"js",children:"import { PuppeteerCrawler } from 'crawlee';\n\nconst crawler = new PuppeteerCrawler({\n    browserPoolOptions: {\n        useFingerprints: false,\n    },\n    // ...\n});\n"})})]}),"\n",(0,i.jsx)(r.h2,{id:"camoufox",children:"Camoufox"}),"\n",(0,i.jsxs)(r.p,{children:["For some protections, using our integrated solutions is not enough, one example could be the Cloudflare challenge. For such pages, you can try ",(0,i.jsx)(r.a,{href:"https://camoufox.com/",target:"_blank",rel:"noopener",children:"Camoufox"}),", a custom stealthy build of Firefox for web scraping. It might not get you through the challenge automatically, but with our ",(0,i.jsx)(r.code,{children:"handleCloudflareChallenge"})," helper, it should be able to successfully mimic the required user action and get you through it."]}),"\n",(0,i.jsx)(l.default,{language:"ts",children:"import { PlaywrightCrawler } from 'crawlee';\nimport { launchOptions } from 'camoufox-js';\nimport { firefox } from 'playwright';\n\nconst crawler = new PlaywrightCrawler({\n    postNavigationHooks: [\n        async ({ handleCloudflareChallenge }) => {\n            await handleCloudflareChallenge();\n        },\n    ],\n    launchContext: {\n        launcher: firefox,\n        launchOptions: await launchOptions({\n            headless: true,\n        }),\n    },\n    // ...\n});\n"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Related links"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://github.com/apify/fingerprint-suite",target:"_blank",rel:"noopener",children:"Fingerprint Suite Docs"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://docs.apify.com/academy/anti-scraping",target:"_blank",rel:"noopener",children:"Apify Academy anti-scraping course"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://github.com/apify/camoufox-js",target:"_blank",rel:"noopener",children:"Camoufox JS wrapper"})}),"\n"]})]})}function g(e={}){let{wrapper:r}={...(0,a.a)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}},97645:function(e,r,n){n.d(r,{Z:()=>a});var t=n("85893");n("67294");var i=n("67026");function a(e){let{children:r,hidden:n,className:a}=e;return(0,t.jsx)("div",{role:"tabpanel",className:(0,i.Z)("tabItem_Ymn6",a),hidden:n,children:r})}},58168:function(e,r,n){n.d(r,{Z:()=>b});var t=n("85893"),i=n("67294"),a=n("67026"),o=n("34718"),s=n("16550"),l=n("8714"),c=n("89207"),u=n("69413"),d=n("54510");function h(e){return i.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||i.isValidElement(e)&&function(e){let{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){let{value:r,tabValues:n}=e;return n.some(e=>e.value===r)}var g=n("6735");function f(e){let{className:r,block:n,selectedValue:i,selectValue:s,tabValues:l}=e,c=[],{blockElementScrollPositionUntilNextRender:u}=(0,o.o5)(),d=e=>{let r=e.currentTarget,n=l[c.indexOf(r)].value;n!==i&&(u(r),s(n))},h=e=>{let r=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{let n=c.indexOf(e.currentTarget)+1;r=c[n]??c[0];break}case"ArrowLeft":{let n=c.indexOf(e.currentTarget)-1;r=c[n]??c[c.length-1]}}r?.focus()};return(0,t.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":n},r),children:l.map(e=>{let{value:r,label:n,attributes:o}=e;return(0,t.jsx)("li",{role:"tab",tabIndex:i===r?0:-1,"aria-selected":i===r,ref:e=>{c.push(e)},onKeyDown:h,onClick:d,...o,className:(0,a.Z)("tabs__item","tabItem_LNqP",o?.className,{"tabs__item--active":i===r}),children:n??r},r)})})}function w(e){let{lazy:r,children:n,selectedValue:o}=e,s=(Array.isArray(n)?n:[n]).filter(Boolean);if(r){let e=s.find(e=>e.props.value===o);return e?(0,i.cloneElement)(e,{className:(0,a.Z)("margin-top--md",e.props.className)}):null}return(0,t.jsx)("div",{className:"margin-top--md",children:s.map((e,r)=>(0,i.cloneElement)(e,{key:r,hidden:e.props.value!==o}))})}function m(e){let r=function(e){let{defaultValue:r,queryString:n=!1,groupId:t}=e,a=function(e){let{values:r,children:n}=e;return(0,i.useMemo)(()=>{let e=r??h(n).map(e=>{let{props:{value:r,label:n,attributes:t,default:i}}=e;return{value:r,label:n,attributes:t,default:i}});return!function(e){let r=(0,u.lx)(e,(e,r)=>e.value===r.value);if(r.length>0)throw Error(`Docusaurus error: Duplicate values "${r.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[r,n])}(e),[o,g]=(0,i.useState)(()=>(function(e){let{defaultValue:r,tabValues:n}=e;if(0===n.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(r){if(!p({value:r,tabValues:n}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${r}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return r}let t=n.find(e=>e.default)??n[0];if(!t)throw Error("Unexpected error: 0 tabValues");return t.value})({defaultValue:r,tabValues:a})),[f,w]=function(e){let{queryString:r=!1,groupId:n}=e,t=(0,s.k6)(),a=function(e){let{queryString:r=!1,groupId:n}=e;if("string"==typeof r)return r;if(!1===r)return null;if(!0===r&&!n)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:r,groupId:n});return[(0,c._X)(a),(0,i.useCallback)(e=>{if(!a)return;let r=new URLSearchParams(t.location.search);r.set(a,e),t.replace({...t.location,search:r.toString()})},[a,t])]}({queryString:n,groupId:t}),[m,b]=function(e){let{groupId:r}=e,n=r?`docusaurus.tab.${r}`:null,[t,a]=(0,d.Nk)(n);return[t,(0,i.useCallback)(e=>{n&&a.set(e)},[n,a])]}({groupId:t}),x=(()=>{let e=f??m;return p({value:e,tabValues:a})?e:null})();return(0,l.Z)(()=>{x&&g(x)},[x]),{selectedValue:o,selectValue:(0,i.useCallback)(e=>{if(!p({value:e,tabValues:a}))throw Error(`Can't select invalid tab value=${e}`);g(e),w(e),b(e)},[w,b,a]),tabValues:a}}(e);return(0,t.jsxs)("div",{className:(0,a.Z)("tabs-container","tabList__CuJ"),children:[(0,t.jsx)(f,{...r,...e}),(0,t.jsx)(w,{...r,...e})]})}function b(e){let r=(0,g.Z)();return(0,t.jsx)(m,{...e,children:h(e.children)},String(r))}},50065:function(e,r,n){n.d(r,{Z:function(){return s},a:function(){return o}});var t=n(67294);let i={},a=t.createContext(i);function o(e){let r=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(a.Provider,{value:r},e.children)}}}]);