"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["33791"],{718:function(e,n,t){t.r(n),t.d(n,{assets:function(){return c},contentTitle:function(){return o},default:function(){return h},frontMatter:function(){return i},metadata:function(){return s},toc:function(){return l}});var s=t(14451),r=t(85893),a=t(50065);let i={slug:"netflix-show-recommender",title:"Building a Netflix show recommender using Crawlee and React",tags:["community"],description:"Create a Netflix show recommendation system using Crawlee to scrape the data, JavaScript to code, and React to build the front end.",image:"./img/create-netflix-show-recommender.webp",authors:["AyushT"]},o="Building a Netflix web show recommender with Crawlee and React",c={image:t(35972).Z,authorsImageUrls:[void 0]},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Creating a React app",id:"creating-a-react-app",level:2},{value:"Adding Scraper code",id:"adding-scraper-code",level:2},{value:"Installation",id:"installation",level:3},{value:"Scraping genres and shows",id:"scraping-genres-and-shows",level:3},{value:"Storing data",id:"storing-data",level:3},{value:"Result",id:"result",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"In this blog, we'll guide you through the process of using Vite and Crawlee to build a website that recommends Netflix shows based on their categories and genres. To do that, we will first scrape the shows and categories from Netflix using Crawlee, and then visualize the scraped data in a React app built with Vite. By the end of this guide, you'll have a functional web show recommender that can provide Netflix show suggestions."}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["One of our community members wrote this blog as a contribution to Crawlee Blog. If you want to contribute blogs like these to Crawlee Blog, please reach out to us on our ",(0,r.jsx)(n.a,{href:"https://apify.com/discord",children:"discord channel"}),"."]})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"How to scrape Netflix using Crawlee and React to build a show recommender",src:t(69490).Z+"",width:"1152",height:"649"})}),"\n",(0,r.jsx)(n.p,{children:"Let\u2019s get started!"}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"To use Crawlee, you need to have Node.js 16 or newer."}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["If you like the posts on the Crawlee blog so far, please consider ",(0,r.jsx)(n.a,{href:"https://github.com/apify/crawlee",children:"giving Crawlee a star on GitHub"}),", it helps us to reach and help more developers."]})}),"\n",(0,r.jsxs)(n.p,{children:["You can install the latest version of Node.js from the ",(0,r.jsx)(n.a,{href:"https://nodejs.org/en/",children:"official website"}),". This great ",(0,r.jsx)(n.a,{href:"https://blog.apify.com/how-to-install-nodejs/",children:"Node.js installation guide"})," gives you tips to avoid issues later on."]}),"\n",(0,r.jsx)(n.h2,{id:"creating-a-react-app",children:"Creating a React app"}),"\n",(0,r.jsx)(n.p,{children:"First, we will create a React app (for the front end) using Vite. Run this command in the terminal to create it:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"npx create-vite@latest\n"})}),"\n",(0,r.jsxs)(n.p,{children:["You can check out the ",(0,r.jsx)(n.a,{href:"https://vitejs.dev/guide/",children:"Vite Docs"})," for more details on how to create a React app."]}),"\n",(0,r.jsx)(n.p,{children:"Once the React app is created, open it in VS Code."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"react",src:t(12634).Z+"",width:"1188",height:"947"})}),"\n",(0,r.jsx)(n.p,{children:"This will be the structure of your React app."}),"\n",(0,r.jsxs)(n.p,{children:["Run ",(0,r.jsx)(n.code,{children:"npm run dev"})," command in the terminal to run the app."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"viteandreact",src:t(30532).Z+"",width:"1918",height:"1017"})}),"\n",(0,r.jsx)(n.p,{children:"This will be the output displayed."}),"\n",(0,r.jsx)(n.h2,{id:"adding-scraper-code",children:"Adding Scraper code"}),"\n",(0,r.jsx)(n.p,{children:"As per our project requirements, we will scrape the genres and the titles of the shows available on Netflix."}),"\n",(0,r.jsx)(n.p,{children:"Let\u2019s start building the scraper code."}),"\n",(0,r.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,r.jsxs)(n.p,{children:["Run this command to install ",(0,r.jsx)(n.code,{children:"crawlee"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"npm install crawlee\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Crawlee utilizes Cheerio for HTML parsing and scraping of static websites. While faster and ",(0,r.jsx)(n.a,{href:"https://crawlee.dev/docs/guides/scaling-crawlers",children:"less resource-intensive"}),", it can only scrape websites that do not require JavaScript rendering, making it unsuitable for SPAs (single page applications)."]}),"\n",(0,r.jsxs)(n.p,{children:["In this tutorial we can extract data from the HTML structure, so we will go with Cheerio but for extracting data from SPAs or JavaScript-rendered websites, Crawlee also supports headless browser libraries like ",(0,r.jsx)(n.a,{href:"https://playwright.dev/",children:"Playwright"})," and ",(0,r.jsx)(n.a,{href:"https://pptr.dev/",children:"Puppeteer"})]}),"\n",(0,r.jsx)(n.p,{children:"After installing the libraries, it\u2019s time to create the scraper code."}),"\n",(0,r.jsxs)(n.p,{children:["Create a file in ",(0,r.jsx)(n.code,{children:"src"})," directory and name it ",(0,r.jsx)(n.code,{children:"scraper.js"}),". The entire scraper code will be created in this file."]}),"\n",(0,r.jsx)(n.h3,{id:"scraping-genres-and-shows",children:"Scraping genres and shows"}),"\n",(0,r.jsxs)(n.p,{children:["To scrape the genres and shows, we will utilize the ",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Learn/Common%60questions/Tools%60and%60setup/What%60are%60browser%60developer%60tools",children:"browser DevTools"})," to identify the tags and CSS selectors targeting the genre elements on the Netflix website."]}),"\n",(0,r.jsxs)(n.p,{children:["We can capture the HTML structure and call ",(0,r.jsx)(n.code,{children:"$(element)"})," to query the element's subtree."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"genre",src:t(14941).Z+"",width:"1556",height:"732"})}),"\n",(0,r.jsxs)(n.p,{children:["Here, we can observe that the name of the genre is captured by a ",(0,r.jsx)(n.code,{children:"span"})," tag with ",(0,r.jsx)(n.code,{children:"nm-collections-row-name"})," class. So we can use the ",(0,r.jsx)(n.code,{children:"span.nm-collections-row-name"})," selector to capture this and similar elements."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"title",src:t(58141).Z+"",width:"1755",height:"717"})}),"\n",(0,r.jsxs)(n.p,{children:["Similarly, we can observe that the title of the show is captured by the ",(0,r.jsx)(n.code,{children:"span"})," tag having ",(0,r.jsx)(n.code,{children:"nm-collections-title-name"})," class. So we can use the ",(0,r.jsx)(n.code,{children:"span.nm-collections-title-name"})," selector to capture this and similar elements."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Use parseWithCheerio for efficient HTML parsing\nconst $ = await parseWithCheerio();\n\n// Extract genre and shows directly from the HTML structure\nconst data = $('[data-uia=\"collections-row\"]')\n  .map((_, el) => {\n    const genre = $(el)\n      .find('[data-uia=\"collections-row-title\"]')\n      .text()\n      .trim();\n    const items = $(el)\n      .find('[data-uia=\"collections-title\"]')\n      .map((_, itemEl) => $(itemEl).text().trim())\n      .get();\n    return { genre, items };\n  })\n  .get();\n\nconst genres = data.map((d) => d.genre);\nconst shows = data.map((d) => d.items);\n"})}),"\n",(0,r.jsxs)(n.p,{children:["In the code snippet given above, we are using ",(0,r.jsx)(n.code,{children:"parseWithCheerio"})," to parse the HTML content of the current page and extract ",(0,r.jsx)(n.code,{children:"genres"})," and ",(0,r.jsx)(n.code,{children:"shows"})," information from the HTML structure using Cheerio."]}),"\n",(0,r.jsxs)(n.p,{children:["This will give the ",(0,r.jsx)(n.code,{children:"genres"})," and ",(0,r.jsx)(n.code,{children:"shows"})," array having list of genres and shows stored in it respectively."]}),"\n",(0,r.jsx)(n.h3,{id:"storing-data",children:"Storing data"}),"\n",(0,r.jsxs)(n.p,{children:["Now we have all the data that we want for our project and it\u2019s time to store or save the scraped data. To store the data, Crawlee comes with a ",(0,r.jsx)(n.code,{children:"pushData()"})," method."]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.a,{href:"https://crawlee.dev/docs/introduction/saving-data",children:"pushData()"})," method creates a storage folder in the project directory and stores the scraped data in JSON format."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"await pushData({\n      genres: genres,\n      shows: shows,\n    });\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This will save the ",(0,r.jsx)(n.code,{children:"genres"})," and ",(0,r.jsx)(n.code,{children:"shows"})," arrays as values in the ",(0,r.jsx)(n.code,{children:"genres"})," and ",(0,r.jsx)(n.code,{children:"shows"})," keys."]}),"\n",(0,r.jsx)(n.p,{children:"Here\u2019s the full code that we will use in our project:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'import { CheerioCrawler, log, Dataset } from "crawlee";\n\nconst crawler = new CheerioCrawler({\n  requestHandler: async ({ request, parseWithCheerio, pushData }) => {\n    log.info(`Processing: ${request.url}`);\n\n    // Use parseWithCheerio for efficient HTML parsing\n    const $ = await parseWithCheerio();\n\n    // Extract genre and shows directly from the HTML structure\n    const data = $(\'[data-uia="collections-row"]\')\n      .map((_, el) => {\n        const genre = $(el)\n          .find(\'[data-uia="collections-row-title"]\')\n          .text()\n          .trim();\n        const items = $(el)\n          .find(\'[data-uia="collections-title"]\')\n          .map((_, itemEl) => $(itemEl).text().trim())\n          .get();\n        return { genre, items };\n      })\n      .get();\n\n    // Prepare data for pushing\n    const genres = data.map((d) => d.genre);\n    const shows = data.map((d) => d.items);\n\n    await pushData({\n      genres: genres,\n      shows: shows,\n    });\n  },\n\n  // Limit crawls for efficiency\n  maxRequestsPerCrawl: 20,\n});\n\nawait crawler.run(["https://www.netflix.com/in/browse/genre/1191605"]);\nawait Dataset.exportToJSON("results");\n\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Now, we will run Crawlee to scrape the website. Before running Crawlee, we need to tweak the ",(0,r.jsx)(n.code,{children:"package.json"})," file. We will add the ",(0,r.jsx)(n.code,{children:"start"})," script targeting the ",(0,r.jsx)(n.code,{children:"scraper.js"})," file to run Crawlee."]}),"\n",(0,r.jsxs)(n.p,{children:["Add the following code in ",(0,r.jsx)(n.code,{children:"'scripts'"})," object:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'"start": "node src/scraper.js"\n'})}),"\n",(0,r.jsx)(n.p,{children:"and save it. Now run this command to run Crawlee to scrape the data:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"npm start\n"})}),"\n",(0,r.jsxs)(n.p,{children:["After running this command, you will see a ",(0,r.jsx)(n.code,{children:"storage"})," folder with the ",(0,r.jsx)(n.code,{children:"key_value_stores/default/results.json"})," file. The scraped data will be stored in JSON format in this file."]}),"\n",(0,r.jsxs)(n.p,{children:["Now we can use this JSON data and display it in the ",(0,r.jsx)(n.code,{children:"App.jsx"})," component to create the project."]}),"\n",(0,r.jsxs)(n.p,{children:["In the ",(0,r.jsx)(n.code,{children:"App.jsx"})," component, we will import ",(0,r.jsx)(n.code,{children:"jsonData"})," from the ",(0,r.jsx)(n.code,{children:"results.json"})," file:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'import { useState } from "react";\nimport "./App.css";\nimport jsonData from "../storage/key_value_stores/default/results.json";\n\nfunction HeaderAndSelector({ handleChange }) {\n  return (\n    <>\n      <h1 className="header">Netflix Web Show Recommender</h1>\n      <div className="genre-selector">\n        <select onChange={handleChange} className="select-genre">\n          <option value="">Select your genre</option>\n          {jsonData[0].genres.map((genres, key) => {\n            return (\n              <option key={key} value={key}>\n                {genres}\n              </option>\n            );\n          })}\n        </select>\n      </div>\n    </>\n  );\n}\n\nfunction App() {\n  const [count, setCount] = useState(null);\n\n  const handleChange = (event) => {\n    const value = event.target.value;\n    if (value) setCount(parseInt(value));\n  };\n\n  // Validate count to ensure it is within the bounds of the jsonData.shows array\n  const isValidCount = count !== null && count <= jsonData[0].shows.length;\n\n  return (\n    <div className="app-container">\n      <HeaderAndSelector handleChange={handleChange} />\n      <div className="shows-container">\n        {isValidCount && (\n          <>\n            <div className="shows-list">\n              <ul>\n                {jsonData[0].shows[count].slice(0, 20).map((show, index) => (\n                  <li key={index} className="show-item">\n                    {show}\n                  </li>\n                ))}\n              </ul>\n            </div>\n            <div className="shows-list">\n              <ul>\n                {jsonData[0].shows[count].slice(20).map((show, index) => (\n                  <li key={index} className="show-item">\n                    {show}\n                  </li>\n                ))}\n              </ul>\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n'})}),"\n",(0,r.jsxs)(n.p,{children:["In this code snippet, the ",(0,r.jsx)(n.code,{children:"genre"})," array is used to display the list of genres. User can select their desired genre and based upon that a list of web shows available on Netflix will be displayed using the ",(0,r.jsx)(n.code,{children:"shows"})," array."]}),"\n",(0,r.jsxs)(n.p,{children:["Make sure to update CSS on the ",(0,r.jsx)(n.code,{children:"App.css"})," file from here: ",(0,r.jsx)(n.a,{href:"https://github.com/ayush2390/web-show-recommender/blob/main/src/App.css",children:"https://github.com/ayush2390/web-show-recommender/blob/main/src/App.css"})]}),"\n",(0,r.jsxs)(n.p,{children:["and download and save this image file in main project folder: ",(0,r.jsx)(n.a,{href:"https://raw.githubusercontent.com/ayush2390/web-show-recommender/main/Netflix.png",children:"Download Image"})]}),"\n",(0,r.jsx)(n.p,{children:"Our project is ready!"}),"\n",(0,r.jsx)(n.h2,{id:"result",children:"Result"}),"\n",(0,r.jsx)(n.p,{children:"Now, to run your project on localhost, run this command:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"npm run dev\n"})}),"\n",(0,r.jsx)(n.p,{children:"This command will run your project on localhost. Here is a demo of the project:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"result",src:t(63515).Z+"",width:"1920",height:"1080"})}),"\n",(0,r.jsxs)(n.p,{children:["Project link - ",(0,r.jsx)(n.a,{href:"https://github.com/ayush2390/web-show-recommender",children:"https://github.com/ayush2390/web-show-recommender"})]}),"\n",(0,r.jsx)(n.p,{children:"In this project, we used Crawlee to scrape Netflix; similarly, Crawlee can be used to scrape single application pages (SPAs) and JavaScript-rendered websites. The best part is all of this can be done while coding in JavaScript/TypeScript and using a single library."}),"\n",(0,r.jsxs)(n.p,{children:["If you want to learn more about Crawlee, go through the ",(0,r.jsx)(n.a,{href:"https://crawlee.dev/docs/quick-start",children:"documentation"})," and this step-by-step ",(0,r.jsx)(n.a,{href:"https://blog.apify.com/crawlee-web-scraping-tutorial/",children:"Crawlee web scraping tutorial"})," from Apify."]})]})}function h(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},35972:function(e,n,t){t.d(n,{Z:function(){return s}});let s=t.p+"assets/images/create-netflix-show-recommender-c429467c4a972badaa0b8ab414454250.webp"},69490:function(e,n,t){t.d(n,{Z:function(){return s}});let s=t.p+"assets/images/create-netflix-show-recommender-c429467c4a972badaa0b8ab414454250.webp"},14941:function(e,n,t){t.d(n,{Z:function(){return s}});let s=t.p+"assets/images/genre-cea03ab54c084a8df3139bf584920062.webp"},12634:function(e,n,t){t.d(n,{Z:function(){return s}});let s=t.p+"assets/images/react-646682cf5586bf230bf98086a4323845.webp"},63515:function(e,n,t){t.d(n,{Z:function(){return s}});let s=t.p+"assets/images/result-021f50e0c1a5870d2448701c8ca6042d.gif"},58141:function(e,n,t){t.d(n,{Z:function(){return s}});let s=t.p+"assets/images/title-b56306b68714d95cc9e45168906a045f.webp"},30532:function(e,n,t){t.d(n,{Z:function(){return s}});let s=t.p+"assets/images/viteandreact-57c4bb4028b4d6b7cc9a22b32b70d3f7.webp"},50065:function(e,n,t){t.d(n,{Z:function(){return o},a:function(){return i}});var s=t(67294);let r={},a=s.createContext(r);function i(e){let n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:n},e.children)}},14451:function(e){e.exports=JSON.parse('{"permalink":"/blog/netflix-show-recommender","source":"@site/blog/2024/06-10-creating-a-netflix-show-recommender-using-crawlee-and-react/index.md","title":"Building a Netflix show recommender using Crawlee and React","description":"Create a Netflix show recommendation system using Crawlee to scrape the data, JavaScript to code, and React to build the front end.","date":"2024-06-10T00:00:00.000Z","tags":[{"inline":true,"label":"community","permalink":"/blog/tags/community"}],"readingTime":6.53,"hasTruncateMarker":true,"authors":[{"name":"Ayush Thakur","title":"Community Member of Crawlee","url":"https://github.com/ayush2390","socials":{"x":"https://x.com/JSAyushThakur","github":"https://github.com/ayush2390"},"imageURL":"https://avatars.githubusercontent.com/u/43995654?v=4","key":"AyushT","page":null}],"frontMatter":{"slug":"netflix-show-recommender","title":"Building a Netflix show recommender using Crawlee and React","tags":["community"],"description":"Create a Netflix show recommendation system using Crawlee to scrape the data, JavaScript to code, and React to build the front end.","image":"./img/create-netflix-show-recommender.webp","authors":["AyushT"]},"unlisted":false,"prevItem":{"title":"How Crawlee uses tiered proxies to avoid getting blocked","permalink":"/blog/proxy-management-in-crawlee"},"nextItem":{"title":"Scrapy vs. Crawlee","permalink":"/blog/scrapy-vs-crawlee"}}')}}]);