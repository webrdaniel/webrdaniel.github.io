<!doctype html><html lang=en dir=ltr class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.7.0"><title data-rh=true>Current problems and mistakes of web scraping in Python and tricks to solve them! | Crawlee for JavaScript · Build reliable crawlers. Fast.</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://crawlee.dev/blog/common-problems-in-web-scraping><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docusaurus_tag content=default><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docsearch:docusaurus_tag content=default><meta data-rh=true name=og:description content="Crawlee helps you build and maintain your crawlers. It's open source, but built by developers who scrape millions of pages every day for a living."><meta data-rh=true property=og:title content="Current problems and mistakes of web scraping in Python and tricks to solve them! | Crawlee for JavaScript · Build reliable crawlers. Fast."><meta data-rh=true name=description content="Current problems and mistakes that developers encounters while scraping and crawling the internet with the advises and solution from an web scraping expert."><meta data-rh=true property=og:description content="Current problems and mistakes that developers encounters while scraping and crawling the internet with the advises and solution from an web scraping expert."><meta data-rh=true property=og:image content=https://crawlee.dev/assets/images/problems-in-scraping-ba4136041d4e47f622b3c1a3115efc4d.webp><meta data-rh=true name=twitter:image content=https://crawlee.dev/assets/images/problems-in-scraping-ba4136041d4e47f622b3c1a3115efc4d.webp><meta data-rh=true property=og:type content=article><meta data-rh=true property=article:published_time content=2024-08-20T00:00:00.000Z><meta data-rh=true property=article:author content=https://github.com/Mantisus><meta data-rh=true property=article:tag content=community><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://crawlee.dev/blog/common-problems-in-web-scraping><link data-rh=true rel=alternate href=https://crawlee.dev/blog/common-problems-in-web-scraping hreflang=en><link data-rh=true rel=alternate href=https://crawlee.dev/blog/common-problems-in-web-scraping hreflang=x-default><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@id":"https://crawlee.dev/blog/common-problems-in-web-scraping","@type":"BlogPosting","author":{"@type":"Person","description":"Community Member of Crawlee and web scraping expert","image":"https://avatars.githubusercontent.com/u/34358312?v=4","name":"Max","url":"https://github.com/Mantisus"},"datePublished":"2024-08-20T00:00:00.000Z","description":"Current problems and mistakes that developers encounters while scraping and crawling the internet with the advises and solution from an web scraping expert.","headline":"Current problems and mistakes of web scraping in Python and tricks to solve them!","image":{"@id":"https://crawlee.dev/assets/images/problems-in-scraping-ba4136041d4e47f622b3c1a3115efc4d.webp","@type":"ImageObject","caption":"title image for the blog post: Current problems and mistakes of web scraping in Python and tricks to solve them!","contentUrl":"https://crawlee.dev/assets/images/problems-in-scraping-ba4136041d4e47f622b3c1a3115efc4d.webp","url":"https://crawlee.dev/assets/images/problems-in-scraping-ba4136041d4e47f622b3c1a3115efc4d.webp"},"isPartOf":{"@id":"https://crawlee.dev/blog","@type":"Blog","name":"Crawlee Blog - learn how to build better scrapers"},"keywords":[],"mainEntityOfPage":"https://crawlee.dev/blog/common-problems-in-web-scraping","name":"Current problems and mistakes of web scraping in Python and tricks to solve them!","url":"https://crawlee.dev/blog/common-problems-in-web-scraping"}</script><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="Crawlee for JavaScript · Build reliable crawlers. Fast. RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="Crawlee for JavaScript · Build reliable crawlers. Fast. Atom Feed"><link rel=search type=application/opensearchdescription+xml title="Crawlee for JavaScript · Build reliable crawlers. Fast." href=/opensearch.xml><!-- Google Tag Manager --><script>!function(e,t,a,n,r){e[n]=e[n]||[],e[n].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id="+r+("dataLayer"!=n?"&l="+n:""),g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer","GTM-5P7MCS7")</script><!-- End Google Tag Manager --><script>window.intercomSettings={api_base:"https://api-iam.intercom.io",app_id:"kod1r788"},function(){var t=window,e=t.Intercom;if("function"==typeof e)e("reattach_activator"),e("update",t.intercomSettings);else{var n=document,a=function(){a.c(arguments)};a.q=[],a.c=function(t){a.q.push(t)},t.Intercom=a;var i=function(){var t=n.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://widget.intercom.io/widget/kod1r788";var e=n.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)};"complete"===document.readyState?i():t.attachEvent?t.attachEvent("onload",i):t.addEventListener("load",i,!1)}}()</script><script src=/js/custom.js></script><link rel=stylesheet href=/assets/css/styles.79fc5e17.css><script src=/assets/js/runtime~main.1ec70394.js defer></script><script src=/assets/js/main.fa57554f.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":(window.matchMedia("(prefers-color-scheme: light)").matches,"light"),document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/img/crawlee-light.svg><link rel=preload as=image href=/img/crawlee-dark.svg><link rel=preload as=image href=/img/crawlee-javascript-light.svg><link rel=preload as=image href=/img/crawlee-javascript-dark.svg><link rel=preload as=image href=/img/crawlee-python-light.svg><link rel=preload as=image href=/img/crawlee-python-dark.svg><link rel=preload as=image href="https://avatars.githubusercontent.com/u/34358312?v=4"><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class=navbar__items><div class=navbarLogo__GY_><div class=logoWithArrows_cB9I><a class="logoImage_a28E sidebarLogo" href=/><img src=/img/crawlee-light.svg alt=Crawlee class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/crawlee-dark.svg alt=Crawlee class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><svg xmlns=http://www.w3.org/2000/svg width=16 height=16 fill=none viewBox="0 0 16 16"><g stroke=#B2B8CC stroke-linecap=round stroke-linejoin=round><path d="M5.334 6 8 3.333 10.667 6M10.667 10 8 12.667 5.334 10"/></g></svg></div><div class=menuWrapper_zUZ_><div class=menu_CQ3p><a class=menuItem_QSny href=/js><img src=/img/crawlee-javascript-light.svg alt="Crawlee JavaScript" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/crawlee-javascript-dark.svg alt="Crawlee JavaScript" class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><a href=https://crawlee.dev/python target=_self rel=dofollow class=menuItem_QSny><img src=/img/crawlee-python-light.svg alt="Crawlee Python" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/crawlee-python-dark.svg alt="Crawlee Python" class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><a class=menuItem_QSny href=/><img src=/img/crawlee-light.svg alt=Crawlee class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/crawlee-dark.svg alt=Crawlee class="themedComponent_mlkZ themedComponent--dark_xIcU"><svg xmlns=http://www.w3.org/2000/svg width=17 height=16 fill=none viewBox="0 0 17 16"><path fill=#555D76 d="M14.742 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0l-3.25-3.25a.751.751 0 0 1 1.06-1.06l2.72 2.72 6.72-6.72a.75.75 0 0 1 1.06 0"/></svg></a></div></div></div><div class="navbarItems_fVuF navbarItems__leftMargin_FZoS"><a class="navbar__item navbar__link" href=/js>JavaScript</a><a href=https://crawlee.dev/python target=_self rel=dofollow class="navbar__item navbar__link">Python</a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/blog>Blog</a></div></div><div class="navbar__items navbar__items--right"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class=row><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role=group><h3 class=yearGroupHeading_rMGB>2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/superscraper-with-crawlee>Inside implementing SuperScraper with Crawlee</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/crawlee-for-python-v05>Crawlee for Python v0.5</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/scrape-crunchbase-python>How to scrape Crunchbase using Python in 2024 (Easy Guide)</a></ul></div><div role=group><h3 class=yearGroupHeading_rMGB>2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/scrape-google-maps>How to scrape Google Maps data using Python</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/scrape-google-search>How to scrape Google search results with Python</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/graphql-persisted-query>Reverse engineering GraphQL persistedQuery extension</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/web-scraping-tips>12 tips on how to think like a web scraping expert</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/linkedin-job-scraper-python>How to create a LinkedIn job scraper in Python with Crawlee</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/scrape-using-jsdom>Optimizing web scraping: Scraping auth data using JSDOM</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/scraping-dynamic-websites-using-python>Web scraping of a dynamic website using Python with HTTP Client</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/infinite-scroll-using-python>How to scrape infinite scrolling webpages with Python</a><li class=sidebarItem__DBe><a aria-current=page class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href=/blog/common-problems-in-web-scraping>Current problems and mistakes of web scraping in Python and tricks to solve them!</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/launching-crawlee-python>Announcing Crawlee for Python: Now you can use Python to build reliable web crawlers</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/proxy-management-in-crawlee>How Crawlee uses tiered proxies to avoid getting blocked</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/netflix-show-recommender>Building a Netflix show recommender using Crawlee and React</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/scrapy-vs-crawlee>Scrapy vs. Crawlee</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/how-to-scrape-amazon>How to scrape Amazon products</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/blog/crawlee-blog-launch>Launching Crawlee Blog</a></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class=title_xvU1>Current problems and mistakes of web scraping in Python and tricks to solve them!</h1><div class="container_iJTo margin-vert--md"><time datetime=2024-08-20T00:00:00.000Z>August 20, 2024</time> · <!-- -->15 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_q4o9"><div class="avatar margin-bottom--sm"><a href=https://github.com/Mantisus target=_blank rel="noopener noreferrer" class=avatar__photo-link><img class=avatar__photo src="https://avatars.githubusercontent.com/u/34358312?v=4" alt=Max></a><div class=avatar__intro><div class=avatar__name><a href=https://github.com/Mantisus target=_blank rel="noopener noreferrer"><span>Max</span></a></div><small class=avatar__subtitle>Community Member of Crawlee and web scraping expert</small></div></div></div></div></header><div id=__blog-post-container class=markdown><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=introduction>Introduction<a href=#introduction class=hash-link aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>Greetings! I'm <a href=https://apify.com/mantisus target=_blank rel="noopener noreferrer">Max</a>, a Python developer from Ukraine, a developer with expertise in web scraping, data analysis, and processing.</p>
<p>My journey in web scraping started in 2016 when I was solving lead generation challenges for a small company. Initially, I used off-the-shelf solutions such as <a href=https://www.import.io/ target=_blank rel="noopener noreferrer">Import.io</a> and Kimono Labs. However, I quickly encountered limitations such as blocking, inaccurate data extraction, and performance issues. This led me to learn Python. Those were the glory days when <a href=https://requests.readthedocs.io/en/latest/ target=_blank rel="noopener noreferrer"><code>requests</code></a> and <a href=https://lxml.de/ target=_blank rel="noopener noreferrer"><code>lxml</code></a>/<a href=https://beautiful-soup-4.readthedocs.io/en/latest/ target=_blank rel="noopener noreferrer"><code>beautifulsoup</code></a> were enough to extract data from most websites. And if you knew how to work with threads, you were already a respected expert :)</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p>One of our community members wrote this blog as a contribution to Crawlee Blog. If you want to contribute blogs like these to Crawlee Blog, please reach out to us on our <a href=https://apify.com/discord target=_blank rel="noopener noreferrer">discord channel</a>.</div></div>
<p>As a freelancer, I've built small solutions and large, complex data mining systems for products over the years.</p>
<p>Today, I want to discuss the realities of <a href=https://blog.apify.com/web-scraping-python/ target=_blank rel="noopener noreferrer">web scraping with Python in 2024</a>. We'll look at the mistakes I sometimes see and the problems you'll encounter and offer solutions to some of them.</p>
<p>Let's get started.</p>
<p>Just take <code>requests</code> and <code>beautifulsoup</code> and start making a lot of money...</p>
<p>No, this is not that kind of article.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=1-i-got-a-200-response-from-the-server-but-its-an-unreadable-character-set>1. "I got a 200 response from the server, but it's an unreadable character set."<a href=#1-i-got-a-200-response-from-the-server-but-its-an-unreadable-character-set class=hash-link aria-label='Direct link to 1. "I got a 200 response from the server, but it&apos;s an unreadable character set."' title='Direct link to 1. "I got a 200 response from the server, but it&apos;s an unreadable character set."'>​</a></h2>
<p>Yes, it can be surprising. But I've seen this message from customers and developers six years ago, four years ago, and in 2024. I read a post on Reddit just a few months ago about this issue.</p>
<p>Let's look at a simple code example. This will work for <code>requests</code>, <a href=https://www.python-httpx.org/ target=_blank rel="noopener noreferrer"><code>httpx</code></a>, and <a href=https://docs.aiohttp.org/en/stable/client.html#aiohttp-client target=_blank rel="noopener noreferrer"><code>aiohttp</code></a> with a clean installation and no extensions.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> httpx</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">url </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'https://www.wayfair.com/'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">headers </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"User-Agent"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Accept"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Accept-Language"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"en-US,en;q=0.5"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Accept-Encoding"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"gzip, deflate, br, zstd"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Connection"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"keep-alive"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">response </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> httpx</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">url</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> headers</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">headers</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>print</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">response</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">content</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The print result will be similar to:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">b</span><span class="token string" style=color:#e3116c>'\x83\x0c\x00\x00\xc4\r\x8e4\x82\x8a'</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>It's not an error - it's a perfectly valid server response. It's encoded somehow.</p>
<p>The answer lies in the <code>Accept-Encoding</code> header. In the example above, I just copied it from my browser, so it lists all the compression methods my browser supports: "gzip, deflate, br, zstd". The Wayfair backend supports compression with "br", which is <a href=https://github.com/google/brotli target=_blank rel="noopener noreferrer">Brotli</a>, and uses it as the most efficient method.</p>
<p>This can happen if none of the libraries listed above have a <code>Brotli</code> dependency among their standard dependencies. However, they all support decompression from this format if you already have <code>Brotli</code> installed.</p>
<p>Therefore, it's sufficient to install the appropriate library:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">pip </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> Brotli</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>This will allow you to get the result of the print:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">b</span><span class="token string" style=color:#e3116c>'&lt;!DOCTYPE '</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>You can obtain the same result for <code>aiohttp</code> and <code>httpx</code> by doing the installation with extensions:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">pip </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> aiohttp</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">speedups</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">pip </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> httpx</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">brotli</span><span class="token punctuation" style=color:#393A34>]</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>By the way, adding the <code>brotli</code> dependency was my first contribution to <a href=https://github.com/apify/crawlee-python target=_blank rel="noopener noreferrer"><code>crawlee-python</code></a>. They use <code>httpx</code> as the base HTTP client.</p>
<p>You may have also noticed that a new supported data compression format <a href=https://github.com/facebook/zstd target=_blank rel="noopener noreferrer"><code>zstd</code></a> appeared some time ago. I haven't seen any backends that use it yet, but <code>httpx</code> will support decompression in versions above 0.28.0. I already use it to compress server response dumps in my projects; it shows incredible efficiency in asynchronous solutions with <a href=https://github.com/Tinche/aiofiles target=_blank rel="noopener noreferrer"><code>aiofiles</code></a>.</p>
<p>The most common solution to this situation that I've seen is for developers to simply stop using the <code>Accept-Encoding</code> header, thus getting an uncompressed response from the server. Why is that bad? The <a href=https://www.wayfair.com/ target=_blank rel="noopener noreferrer">main page of Wayfair</a> takes about 1 megabyte uncompressed and about 0.165 megabytes compressed.</p>
<p>Therefore, in the absence of this header:</p>
<ul>
<li>You increase the load on your internet bandwidth.</li>
<li>If you use a proxy with traffic, you increase the cost of each of your requests.</li>
<li>You increase the load on the server's internet bandwidth.</li>
<li>You're revealing yourself as a scraper, since any browser uses compression.</li>
</ul>
<p>But I think the problem is a bit deeper than that. Many web scraping developers simply don't understand what the headers they use do. So if this applies to you, when you're working on your next project, read up on these things; they may surprise you.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=2-i-use-headers-as-in-an-incognito-browser-but-i-get-a-403-response-heres-johnn--i-mean-cloudflare>2. "I use headers as in an incognito browser, but I get a 403 response". Here's Johnn-... I mean, Cloudflare<a href=#2-i-use-headers-as-in-an-incognito-browser-but-i-get-a-403-response-heres-johnn--i-mean-cloudflare class=hash-link aria-label='Direct link to 2. "I use headers as in an incognito browser, but I get a 403 response". Here&apos;s Johnn-... I mean, Cloudflare' title='Direct link to 2. "I use headers as in an incognito browser, but I get a 403 response". Here&apos;s Johnn-... I mean, Cloudflare'>​</a></h2>
<p>Yes, that's right. 2023 brought us not only Large Language Models like ChatGPT but also improved <a href=https://www.cloudflare.com/ target=_blank rel="noopener noreferrer">Cloudflare</a> protection.</p>
<p>Those who have been scraping the web for a long time might say, "Well, we've already dealt with DataDome, PerimeterX, InCapsula, and the like."</p>
<p>But Cloudflare has changed the rules of the game. It is one of the largest CDN providers in the world, serving a huge number of sites. Therefore, its services are available to many sites with a fairly low entry barrier. This makes it radically different from the technologies mentioned earlier, which were implemented purposefully when they wanted to protect the site from scraping.</p>
<p>Cloudflare is the reason why, when you start reading another course on "How to do web scraping using <code>requests</code> and <code>beautifulsoup</code>", you can close it immediately. Because there's a big chance that what you learn will simply not work on any "decent" website.</p>
<p>Let's look at another simple code example:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> httpx </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> Client</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">client </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Client</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">http2</span><span class="token operator" style=color:#393A34>=</span><span class="token boolean" style=color:#36acaa>True</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">url </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'https://www.g2.com/'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">headers </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"User-Agent"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Accept"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Accept-Language"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"en-US,en;q=0.5"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Accept-Encoding"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"gzip, deflate, br, zstd"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Connection"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"keep-alive"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">response </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> client</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">url</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> headers</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">headers</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>print</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">response</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Of course, the response would be <a href=https://blog.apify.com/web-scraping-how-to-solve-403-errors/ target=_blank rel="noopener noreferrer">403</a>.</p>
<p>What if we use <a href=https://curl.se/docs/manpage.html target=_blank rel="noopener noreferrer"><code>curl</code></a>?</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>curl</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-XGET</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-H</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0"'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-H</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-H</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'Accept-Language: en-US,en;q=0.5'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-H</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'Connection: keep-alive'</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'https://www.g2.com/'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-s</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-o</span><span class="token plain"> /dev/null </span><span class="token parameter variable" style=color:#36acaa>-w</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"%{http_code}</span><span class="token string entity" style=color:#36acaa>\n</span><span class="token string" style=color:#e3116c>"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Also 403.</p>
<p>Why is this happening?</p>
<p>Because Cloudflare uses TLS fingerprints of many HTTP clients popular among developers, site administrators can also customize how aggressively Cloudflare blocks clients based on these fingerprints.</p>
<p>For <code>curl</code>, we can solve it like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>curl</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-XGET</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-H</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0"'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-H</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-H</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'Accept-Language: en-US,en;q=0.5'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-H</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'Connection: keep-alive'</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'https://www.g2.com/'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--tlsv1.3</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-s</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-o</span><span class="token plain"> /dev/null </span><span class="token parameter variable" style=color:#36acaa>-w</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"%{http_code}</span><span class="token string entity" style=color:#36acaa>\n</span><span class="token string" style=color:#e3116c>"</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>You might expect me to write here an equally elegant solution for <code>httpx</code>, but no. About six months ago, you could do the "dirty trick" and change the basic <a href=https://www.encode.io/httpcore/ target=_blank rel="noopener noreferrer"><code>httpcore</code></a> parameters that it passes to <a href=https://github.com/python-hyper/h2 target=_blank rel="noopener noreferrer"><code>h2</code></a>, which are responsible for the HTTP2 handshake. But now, as I'm writing this article, that doesn't work anymore.</p>
<p>There are different approaches to getting around this. But let's solve it by manipulating TLS.</p>
<p>The bad news is that all the Python clients I know of use the <a href=https://docs.python.org/3/library/ssl.html target=_blank rel="noopener noreferrer"><code>ssl</code></a> library to handle TLS. And it doesn't give you the ability to manipulate TLS subtly.</p>
<p>The good news is that the Python community is great and implements solutions that exist in other programming languages.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=the-first-way-to-solve-this-problem-is-to-use-tls-client>The first way to solve this problem is to use <a href=https://github.com/FlorianREGAZ/Python-Tls-Client target=_blank rel="noopener noreferrer">tls-client</a><a href=#the-first-way-to-solve-this-problem-is-to-use-tls-client class=hash-link aria-label="Direct link to the-first-way-to-solve-this-problem-is-to-use-tls-client" title="Direct link to the-first-way-to-solve-this-problem-is-to-use-tls-client">​</a></h3>
<p>This Python wrapper around the <a href=https://github.com/bogdanfinn/tls-client target=_blank rel="noopener noreferrer">Golang library</a> provides an API similar to <code>requests</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">pip </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> tls-client</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> tls_client </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> Session</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">client </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Session</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">client_identifier</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"firefox_120"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">url </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'https://www.g2.com/'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">headers </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"User-Agent"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Accept"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Accept-Language"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"en-US,en;q=0.5"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Accept-Encoding"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"gzip, deflate, br, zstd"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Connection"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"keep-alive"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">response </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> client</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">url</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> headers</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">headers</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>print</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">response</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The <code>tls_client</code> supports TLS presets for popular browsers, the relevance of which is maintained by developers. To use this, you must pass the necessary <code>client_identifier</code>. However, the library also allows for subtle manual manipulation of TLS.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=the-second-way-to-solve-this-problem-is-to-use-curl_cffi>The second way to solve this problem is to use <a href=https://github.com/yifeikong/curl_cffi target=_blank rel="noopener noreferrer">curl_cffi</a><a href=#the-second-way-to-solve-this-problem-is-to-use-curl_cffi class=hash-link aria-label="Direct link to the-second-way-to-solve-this-problem-is-to-use-curl_cffi" title="Direct link to the-second-way-to-solve-this-problem-is-to-use-curl_cffi">​</a></h3>
<p>This wrapper around the C library patches curl and provides an API similar to <code>requests</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">pip </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> curl_cffi</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> curl_cffi </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> requests</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">url </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'https://www.g2.com/'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">headers </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"User-Agent"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Accept"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Accept-Language"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"en-US,en;q=0.5"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Accept-Encoding"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"gzip, deflate, br, zstd"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Connection"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"keep-alive"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">response </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> requests</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">url</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> headers</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">headers</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> impersonate</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"chrome124"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>print</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">response</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>curl_cffi also provides <a href=https://curl-cffi.readthedocs.io/en/latest/impersonate.html#supported-browser-versions target=_blank rel="noopener noreferrer">TLS presets</a> for some browsers, which are specified via the <code>impersonate</code> parameter. It also provides options for <a href=https://curl-cffi.readthedocs.io/en/latest/impersonate.html#how-to-use-my-own-fingerprints-other-than-the-builtin-ones-e-g-okhttp target=_blank rel="noopener noreferrer">subtle manual manipulation of TLS</a>.</p>
<p>I think someone just said, "They're literally doing the same thing." That's right, and they're both still very raw.</p>
<p>Let's do some simple comparisons:</p>
<table><thead><tr><th style=text-align:center>Feature<th style=text-align:center>tls_client<th style=text-align:center>curl_cffi<tbody><tr><td style=text-align:center>TLS preset<td style=text-align:center>+<td style=text-align:center>+<tr><td style=text-align:center>TLS manual<td style=text-align:center>+<td style=text-align:center>+<tr><td style=text-align:center>async support<td style=text-align:center>-<td style=text-align:center>+<tr><td style=text-align:center>big company support<td style=text-align:center>-<td style=text-align:center>+<tr><td style=text-align:center>number of contributors<td style=text-align:center>-<td style=text-align:center>+</table>
<p>Obviously, <code>curl_cffi</code> wins in this comparison. But as an active user, I have to say that sometimes there are some pretty strange errors that I'm just unsure how to deal with. And let's be honest, so far, they are both pretty raw.</p>
<p>I think we will soon see other libraries that solve this problem.</p>
<p>One might ask, what about <a href=https://scrapy.org/ target=_blank rel="noopener noreferrer"><code>Scrapy</code></a>? I'll be honest: I don't really keep up with their updates. But I haven't heard about <a href=https://www.zyte.com/ target=_blank rel="noopener noreferrer">Zyte</a> doing anything to bypass TLS fingerprinting. So out of the box <code>Scrapy</code> will also be blocked, but nothing is stopping you from using <code>curl_cffi</code> in your Scrapy Spider.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=3-what-about-headless-browsers-and-cloudflare-turnstile>3. What about headless browsers and Cloudflare Turnstile?<a href=#3-what-about-headless-browsers-and-cloudflare-turnstile class=hash-link aria-label="Direct link to 3. What about headless browsers and Cloudflare Turnstile?" title="Direct link to 3. What about headless browsers and Cloudflare Turnstile?">​</a></h2>
<p>Yes, sometimes we need to use headless browsers. Although I'll be honest, from my point of view, they are used too often even when clearly not necessary.</p>
<p>Even in a headless situation, the folks at Cloudflare have managed to make life difficult for the average web scraper by creating a monster called Cloudflare Turnstile.</p>
<p>To test different tools, you can use this demo <a href=https://2captcha.com/demo/cloudflare-turnstile target=_blank rel="noopener noreferrer">page</a>.</p>
<p>To quickly test whether a library works with the browser, you should start by checking the usual non-headless mode. You don't even need to use automation; just open the site using the desired library and act manually.</p>
<p>What libraries are worth checking out for this?</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=candidate-1-playwright--playwright-stealth>Candidate #1 <a href=https://playwright.dev/python/docs/intro target=_blank rel="noopener noreferrer">Playwright</a> + <a href=https://github.com/AtuboDad/playwright_stealth target=_blank rel="noopener noreferrer">playwright-stealth</a><a href=#candidate-1-playwright--playwright-stealth class=hash-link aria-label="Direct link to candidate-1-playwright--playwright-stealth" title="Direct link to candidate-1-playwright--playwright-stealth">​</a></h3>
<p>It'll be blocked and won't let you solve the captcha.</p>
<p>Playwright is a great library for browser automation. However the developers explicitly state that they don't plan to develop it as a web scraping tool.</p>
<p>And I haven't heard of any Python projects that effectively solve this problem.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=candidate-2-undetected_chromedriver>Candidate #2 <a href=https://github.com/ultrafunkamsterdam/undetected-chromedriver target=_blank rel="noopener noreferrer">undetected_chromedriver</a><a href=#candidate-2-undetected_chromedriver class=hash-link aria-label="Direct link to candidate-2-undetected_chromedriver" title="Direct link to candidate-2-undetected_chromedriver">​</a></h3>
<p>It'll be blocked and won't let you solve the captcha.</p>
<p>This is a fairly common library for working with headless browsers in Python, and in some cases, it allows bypassing Cloudflare Turnstile. But on the target website, it is blocked. Also, in my projects, I've encountered at least two other cases where Cloudflare blocked undetected_chromedriver.</p>
<p>In general, undetected_chromedriver is a good library for your projects, especially since it uses good old Selenium under the hood.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=candidate-3-botasaurus-driver>Candidate #3 <a href=https://github.com/omkarcloud/botasaurus-driver target=_blank rel="noopener noreferrer">botasaurus-driver</a><a href=#candidate-3-botasaurus-driver class=hash-link aria-label="Direct link to candidate-3-botasaurus-driver" title="Direct link to candidate-3-botasaurus-driver">​</a></h3>
<p>It allows you to go past the captcha after clicking.</p>
<p>I don't know how its developers pulled this off, but it works. Its main feature is that it was developed specifically for web scraping. It also has a higher-level library to work with - <a href=https://github.com/omkarcloud/botasaurus target=_blank rel="noopener noreferrer">botasaurus</a>.</p>
<p>On the downside, so far, it's pretty raw, and botasaurus-driver has no documentation and has a rather challenging API to work with.</p>
<p>To summarize, most likely, your main library for headless browsing will be <code>undetected_chromedriver</code>. But in some particularly challenging cases, you might need to use <code>botasaurus</code>.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=4-what-about-frameworks>4. What about frameworks?<a href=#4-what-about-frameworks class=hash-link aria-label="Direct link to 4. What about frameworks?" title="Direct link to 4. What about frameworks?">​</a></h2>
<p>High-level frameworks are designed to speed up and ease development by allowing us to focus on business logic, although we often pay the price in flexibility and control.</p>
<p>So, what are the frameworks for web scraping in 2024?</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=scrapy><a href=https://docs.scrapy.org/en/latest/ target=_blank rel="noopener noreferrer">Scrapy</a><a href=#scrapy class=hash-link aria-label="Direct link to scrapy" title="Direct link to scrapy">​</a></h3>
<p>It's impossible to talk about Python web scraping frameworks without mentioning Scrapy. Scrapinghub (now Zyte) first released it in 2008. For 16 years, it has been developed as an open-source library upon which development companies built their business solutions.</p>
<p>Talking about the advantages of <code>Scrapy</code>, you could write a separate article. But I will emphasize the two of them:</p>
<ul>
<li>The huge amount of tutorials that have been released over the years</li>
<li>Middleware libraries are written by the community and are extending their functionality. For example, <a href=https://github.com/scrapy-plugins/scrapy-playwright target=_blank rel="noopener noreferrer"><code>scrapy-playwright</code></a>.</li>
</ul>
<p>But what are the downsides?</p>
<p>In recent years, Zyte has been focusing more on developing its own platform. <code>Scrapy</code> mostly gets fixes only.</p>
<ul>
<li>Lack of development towards bypassing anti-scraping systems. You have to implement them yourself, but then, why do you need a framework?</li>
<li><code>Scrapy</code> was originally developed with the asynchronous framework <code>Twisted</code>. Partial support for <code>asyncio</code> was added only in <a href=https://docs.scrapy.org/en/latest/topics/asyncio.html target=_blank rel="noopener noreferrer"><code>version 2.0</code></a>. Looking through the source code, you may notice some workarounds that were added for this purpose.</li>
</ul>
<p>Thus, <code>Scrapy</code> is a good and proven solution for sites that are not protected against web scraping. You will need to develop and add the necessary solutions to the framework in order to bypass anti-scraping measures.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=botasaurus><a href=https://www.omkar.cloud/botasaurus/ target=_blank rel="noopener noreferrer">Botasaurus</a><a href=#botasaurus class=hash-link aria-label="Direct link to botasaurus" title="Direct link to botasaurus">​</a></h3>
<p>A new framework for web scraping using browser automation, built on <a href=https://github.com/omkarcloud/botasaurus-driver target=_blank rel="noopener noreferrer"><code>botasaurus-driver</code></a>. The initial commit was made on May 9, 2023.</p>
<p>Let's start with its advantages:</p>
<ul>
<li>Allows you to bypass any Claudflare protection as well as many others using <code>botasaurus-driver</code>.</li>
<li>Good documentation for a quick start</li>
</ul>
<p>Downsides include:</p>
<ul>
<li>Browser automation only, not intended for HTTP clients.</li>
<li>Tight coupling with <code>botasaurus-driver</code>; you can't easily replace it with something better if it comes out in the future.</li>
<li>No asynchrony, only multithreading.</li>
<li>At the moment, it's quite raw and still requires fixes for stable operation.</li>
<li>There are very few training materials available at the moment.</li>
</ul>
<p>This is a good framework for quickly building a web scraper based on browser automation. It lacks flexibility and support for HTTP clients, which is crutias for users like me.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=crawlee-for-python><a href=https://www.crawlee.dev/python/ target=_blank rel="noopener noreferrer">Crawlee for Python</a><a href=#crawlee-for-python class=hash-link aria-label="Direct link to crawlee-for-python" title="Direct link to crawlee-for-python">​</a></h3>
<p>A new framework for web scraping in the Python ecosystem. The initial commit was made on Jan 10, 2024, with a release in the media space on July 5, 2024.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_BuS1><p>If you like the blog so far, please consider <a href=https://github.com/apify/crawlee target=_blank rel="noopener noreferrer">giving Crawlee a star on GitHub</a>, it helps us to reach and help more developers.</div></div>
<p>Developed by <a href=https://apify.com/ target=_blank rel="noopener noreferrer">Apify</a>, it is a Python adaptation of their famous JS framework <a href=https://github.com/apify/crawlee target=_blank rel="noopener noreferrer"><code>crawlee</code></a>, first released on Jul 9, 2019.</p>
<p>As this is a completely new solution on the market, it is now in an active design and development stage. The community is also actively involved in its development. So,we can see that the use of <a href=https://github.com/apify/crawlee-python/issues/292 target=_blank rel="noopener noreferrer">curl_cffi</a> is already being discussed. The possibility of creating their own Rust-based client was <a href=https://github.com/apify/crawlee-python/issues/80 target=_blank rel="noopener noreferrer">previously discussed</a>. I hope the company doesn't abandon the idea.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>Crawlee team</div><div class=admonitionContent_BuS1><p>"Yeah, for sure we will keep improving Crawlee for Python for years to come."</div></div>
<p>As I personally would like to see an HTTP client for Python developed and maintained by a major company. And Rust shows itself very well as a library language for Python. Let's remember at least <a href=https://docs.astral.sh/ruff/ target=_blank rel="noopener noreferrer"><code>Ruff</code></a> and <a href=https://docs.pydantic.dev/latest/ target=_blank rel="noopener noreferrer"><code>Pydantic</code></a> v2.</p>
<p>Advantages:</p>
<p>The framework was developed by an established company in the web scraping market, which has well-developed expertise in this sphere.</p>
<ul>
<li>Support for both browser automation and HTTP clients.</li>
<li>Fully asynchronous, based on <code>asyncio</code>.</li>
<li>Active development phase and media activity. As developers listen to the community, it is quite important in this phase.</li>
</ul>
<p>On a separate note, it has a pretty good modular architecture. If developers introduce the ability to switch between several HTTP clients, we will get a rather flexible framework that allows us to easily change the technologies used, with a simple implementation from the development team.</p>
<p>Deficiencies:</p>
<ul>
<li>The framework is new. There are very few training materials available at the moment.</li>
<li>At the moment, it's quite raw and still requires fixes for stable operation, as well as convenient interfaces for configuration.
-There is no implementation of any means of bypassing anti-scraping systems for now other than changing sessions and proxies. But they are being discussed.</li>
</ul>
<p>I believe that how successful <code>crawlee-python</code> turns out to depends primarily on the community. Due to the small number of tutorials, it is not suitable for beginners. However, experienced developers may decide to try it instead of <code>Scrapy</code>.</p>
<p>In the long run, it may turn out to be a better solution than Scrapy and Botasaurus. It already provides flexible tools for working with HTTP clients, automating browsers out of the box, and quickly switching between them. However, it lacks tools to bypass scraping protections, and their implementation in the future may be the deciding factor in choosing a framework for you.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=conclusion>Conclusion<a href=#conclusion class=hash-link aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>If you have read all the way to here, I assume you found it interesting and maybe even helpful :)</p>
<p>The industry is changing and offering new challenges, and if you are professionally involved in web scraping, you will have to keep a close eye on the situation. In some other field, you would remain a developer who makes products using outdated technologies. But in modern web scraping, you become a developer who makes web scrapers that simply don't work.</p>
<p>Also, don't forget that you are part of the larger Python community, and your knowledge can be useful in developing tools that make things happen for all of us. As you can see, many of the tools you need are being built literally right now.</p>
<p>I'll be glad to read your comments. Also, if you need a web scraping expert or do you just want to discuss the article, you can find me on the following platforms: <a href=https://github.com/Mantisus target=_blank rel="noopener noreferrer">Github</a>, <a href=https://www.linkedin.com/in/max-bohomolov/ target=_blank rel="noopener noreferrer">Linkedin</a>, <a href=https://apify.com/mantisus target=_blank rel="noopener noreferrer">Apify</a>, <a href=https://www.upwork.com/freelancers/mantisus target=_blank rel="noopener noreferrer">Upwork</a>, <a href=https://contra.com/mantisus target=_blank rel="noopener noreferrer">Contra</a>.</p>
<p>Thank you for your attention :)</div><footer class=docusaurus-mt-lg><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class=col><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a class="tag_zVej tagRegular_sFm0" href=/blog/tags/community>community</a></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href=/blog/infinite-scroll-using-python><div class=pagination-nav__sublabel>Newer post</div><div class=pagination-nav__label>How to scrape infinite scrolling webpages with Python</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/blog/launching-crawlee-python><div class=pagination-nav__sublabel>Older post</div><div class=pagination-nav__label>Announcing Crawlee for Python: Now you can use Python to build reliable web crawlers</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#introduction class="table-of-contents__link toc-highlight">Introduction</a><li><a href=#1-i-got-a-200-response-from-the-server-but-its-an-unreadable-character-set class="table-of-contents__link toc-highlight">1. "I got a 200 response from the server, but it's an unreadable character set."</a><li><a href=#2-i-use-headers-as-in-an-incognito-browser-but-i-get-a-403-response-heres-johnn--i-mean-cloudflare class="table-of-contents__link toc-highlight">2. "I use headers as in an incognito browser, but I get a 403 response". Here's Johnn-... I mean, Cloudflare</a><ul><li><a href=#the-first-way-to-solve-this-problem-is-to-use-tls-client class="table-of-contents__link toc-highlight">The first way to solve this problem is to use tls-client</a><li><a href=#the-second-way-to-solve-this-problem-is-to-use-curl_cffi class="table-of-contents__link toc-highlight">The second way to solve this problem is to use curl_cffi</a></ul><li><a href=#3-what-about-headless-browsers-and-cloudflare-turnstile class="table-of-contents__link toc-highlight">3. What about headless browsers and Cloudflare Turnstile?</a><ul><li><a href=#candidate-1-playwright--playwright-stealth class="table-of-contents__link toc-highlight">Candidate #1 Playwright + playwright-stealth</a><li><a href=#candidate-2-undetected_chromedriver class="table-of-contents__link toc-highlight">Candidate #2 undetected_chromedriver</a><li><a href=#candidate-3-botasaurus-driver class="table-of-contents__link toc-highlight">Candidate #3 botasaurus-driver</a></ul><li><a href=#4-what-about-frameworks class="table-of-contents__link toc-highlight">4. What about frameworks?</a><ul><li><a href=#scrapy class="table-of-contents__link toc-highlight">Scrapy</a><li><a href=#botasaurus class="table-of-contents__link toc-highlight">Botasaurus</a><li><a href=#crawlee-for-python class="table-of-contents__link toc-highlight">Crawlee for Python</a></ul><li><a href=#conclusion class="table-of-contents__link toc-highlight">Conclusion</a></ul></div></div></div></div></div><footer class="footer_J6tW light"><div class=footerTop_DGOU><div class=footerTopRow_xbYo><div class=footerTopRowLeft__jwX><a width=120 class=footerLogo_Jxa4 href=/><img src=/img/crawlee-light.svg alt="Docusaurus themed image" class="themedComponent_mlkZ themedComponent--light_NVdE" width=120><img src=/img/crawlee-dark.svg alt="Docusaurus themed image" class="themedComponent_mlkZ themedComponent--dark_xIcU" width=120></a><div class=toggle_MW0i><button class="clean-btn toggleButton_yw5v toggleButtonDisabled_BJd7" type=button disabled title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><span><svg viewBox="0 0 13 12" fill=none xmlns=http://www.w3.org/2000/svg width=14 height=14 class=lightToggleIcon_SFTY><g clip-path=url(#clip0_833_8168)><path d="M6.59998 8.49999C7.98069 8.49999 9.09998 7.3807 9.09998 5.99999C9.09998 4.61928 7.98069 3.49999 6.59998 3.49999C5.21926 3.49999 4.09998 4.61928 4.09998 5.99999C4.09998 7.3807 5.21926 8.49999 6.59998 8.49999Z" stroke=currentColor stroke-linecap=round stroke-linejoin=round /><path d="M6.59985 0.5V1.5" stroke=currentColor stroke-linecap=round stroke-linejoin=round /><path d="M6.59985 10.5V11.5" stroke=currentColor stroke-linecap=round stroke-linejoin=round /><path d="M2.7099 2.11L3.4199 2.82" stroke=currentColor stroke-linecap=round stroke-linejoin=round /><path d="M9.77991 9.17999L10.4899 9.88999" stroke=currentColor stroke-linecap=round stroke-linejoin=round /><path d="M1.09998 6H2.09998" stroke=currentColor stroke-linecap=round stroke-linejoin=round /><path d="M11.0999 6H12.0999" stroke=currentColor stroke-linecap=round stroke-linejoin=round /><path d="M2.7099 9.88999L3.4199 9.17999" stroke=currentColor stroke-linecap=round stroke-linejoin=round /><path d="M9.77991 2.82L10.4899 2.11" stroke=currentColor stroke-linecap=round stroke-linejoin=round /></g><defs><clipPath id=clip0_833_8168><rect width=12 height=12 fill=white transform=translate(0.599976) /></clipPath></defs></svg><svg viewBox="0 0 13 12" width=14 height=14 class=darkToggleIcon_ekgs><path d="M10.7001 6.39501C10.6215 7.24611 10.3021 8.05721 9.77927 8.7334C9.25646 9.40959 8.55189 9.92291 7.748 10.2133C6.9441 10.5036 6.07414 10.5591 5.2399 10.3731C4.40565 10.187 3.64164 9.76728 3.03726 9.1629C2.43287 8.55851 2.01312 7.7945 1.8271 6.96026C1.64108 6.12602 1.6965 5.25605 1.98688 4.45216C2.27725 3.64826 2.79056 2.94369 3.46675 2.42088C4.14294 1.89808 4.95404 1.57866 5.80515 1.50001C5.30685 2.17414 5.06707 3.00473 5.12941 3.84071C5.19175 4.6767 5.55208 5.46254 6.14485 6.05531C6.73762 6.64808 7.52346 7.0084 8.35944 7.07074C9.19542 7.13308 10.026 6.8933 10.7001 6.39501Z" stroke=currentColor fill=transparent stroke-linecap=round stroke-linejoin=round /></svg></span></button></div></div><div class=footerTopRowRight_dEd9><div><div class=footerTitle_tbhc>Docs</div><ul class="footerList_lK9E clean-list"><li><a class="footer__link-item footerLink_YJ8n" href=/docs/guides>Guides</a><li><a class="footer__link-item footerLink_YJ8n" href=/docs/examples>Examples</a><li><a class="footer__link-item footerLink_YJ8n" href=/api/core>API reference</a><li><a class="footer__link-item footerLink_YJ8n" href=/api/core/changelog>Changelog</a></ul></div><div><div class=footerTitle_tbhc>Product</div><ul class="footerList_lK9E clean-list"><li><a href=https://discord.com/invite/jyEM2PRvMU target=_blank rel="noopener noreferrer" class="footer__link-item footerLink_YJ8n">Discord<svg xmlns=http://www.w3.org/2000/svg width=16 height=16 fill=none viewBox="0 0 16 16" class=externalLinkIcon_gEsj><path fill=#fff fill-rule=evenodd d="M2 1.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V2.707L1.854 6.854a.5.5 0 1 1-.708-.708L5.293 2H2.5a.5.5 0 0 1-.5-.5" clip-rule=evenodd /></svg></a><li><a href=https://stackoverflow.com/questions/tagged/crawlee target=_blank rel="noopener noreferrer" class="footer__link-item footerLink_YJ8n">Stack Overflow<svg xmlns=http://www.w3.org/2000/svg width=16 height=16 fill=none viewBox="0 0 16 16" class=externalLinkIcon_gEsj><path fill=#fff fill-rule=evenodd d="M2 1.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V2.707L1.854 6.854a.5.5 0 1 1-.708-.708L5.293 2H2.5a.5.5 0 0 1-.5-.5" clip-rule=evenodd /></svg></a><li><a href=https://twitter.com/apify target=_blank rel="noopener noreferrer" class="footer__link-item footerLink_YJ8n">Twitter<svg xmlns=http://www.w3.org/2000/svg width=16 height=16 fill=none viewBox="0 0 16 16" class=externalLinkIcon_gEsj><path fill=#fff fill-rule=evenodd d="M2 1.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V2.707L1.854 6.854a.5.5 0 1 1-.708-.708L5.293 2H2.5a.5.5 0 0 1-.5-.5" clip-rule=evenodd /></svg></a><li><a href=https://www.youtube.com/apify target=_blank rel="noopener noreferrer" class="footer__link-item footerLink_YJ8n">YouTube<svg xmlns=http://www.w3.org/2000/svg width=16 height=16 fill=none viewBox="0 0 16 16" class=externalLinkIcon_gEsj><path fill=#fff fill-rule=evenodd d="M2 1.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V2.707L1.854 6.854a.5.5 0 1 1-.708-.708L5.293 2H2.5a.5.5 0 0 1-.5-.5" clip-rule=evenodd /></svg></a></ul></div><div><div class=footerTitle_tbhc>More</div><ul class="footerList_lK9E clean-list"><li><a href=https://apify.com target=_blank rel="noopener noreferrer" class="footer__link-item footerLink_YJ8n">Apify Platform<svg xmlns=http://www.w3.org/2000/svg width=16 height=16 fill=none viewBox="0 0 16 16" class=externalLinkIcon_gEsj><path fill=#fff fill-rule=evenodd d="M2 1.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V2.707L1.854 6.854a.5.5 0 1 1-.708-.708L5.293 2H2.5a.5.5 0 0 1-.5-.5" clip-rule=evenodd /></svg></a><li><a href=https://docusaurus.io target=_blank rel="noopener noreferrer" class="footer__link-item footerLink_YJ8n">Docusaurus<svg xmlns=http://www.w3.org/2000/svg width=16 height=16 fill=none viewBox="0 0 16 16" class=externalLinkIcon_gEsj><path fill=#fff fill-rule=evenodd d="M2 1.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V2.707L1.854 6.854a.5.5 0 1 1-.708-.708L5.293 2H2.5a.5.5 0 0 1-.5-.5" clip-rule=evenodd /></svg></a><li><a href=https://github.com/apify/crawlee target=_blank rel="noopener noreferrer" class="footer__link-item footerLink_YJ8n">GitHub<svg xmlns=http://www.w3.org/2000/svg width=16 height=16 fill=none viewBox="0 0 16 16" class=externalLinkIcon_gEsj><path fill=#fff fill-rule=evenodd d="M2 1.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V2.707L1.854 6.854a.5.5 0 1 1-.708-.708L5.293 2H2.5a.5.5 0 0 1-.5-.5" clip-rule=evenodd /></svg></a></ul></div></div></div></div><div class=footerBottom_VaxJ><div class=footerBottomRow_vynO><div><svg xmlns=http://www.w3.org/2000/svg width=14 height=12 fill=none viewBox="0 0 14 12" class=hearthIcon_zliG><path fill=#B2B8CC d="M3.653.049a4 4 0 0 1 3.325.95l.025.022.022-.02a4 4 0 0 1 3.156-.96l.164.024a4 4 0 0 1 2.242 6.672l-.12.123-.032.028-4.966 4.919a.67.67 0 0 1-.876.055l-.062-.055-4.996-4.948A4 4 0 0 1 3.653.049"/></svg>Crawlee is forever free and open source</div><div>© 2025 Apify</div></div></div></footer></div>
<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5P7MCS7" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->